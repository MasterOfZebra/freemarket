# –£–ª—É—á—à–µ–Ω–∏—è —è–∑—ã–∫–æ–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ matching

**–î–∞—Ç–∞:** 2025-01-XX
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –Ø–∑—ã–∫–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤ matching
**–ü—Ä–æ–±–ª–µ–º–∞:** Matching —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ equivalence score, –Ω–µ —É—á–∏—Ç—ã–≤–∞—è —è–∑—ã–∫–æ–≤–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `LanguageNormalizer` –≤ `listings_exchange.py`
- Matching —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score: 70% equivalence + 30% language similarity

### 2. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∞–ª–æ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –≤ `SYNONYM_MAP`, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±—Ä–µ–Ω–¥–æ–≤ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –†–∞—Å—à–∏—Ä–µ–Ω `SYNONYM_MAP` —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º:
  - –ë—Ä–µ–Ω–¥–æ–≤ (iPhone, Samsung, Dell, Toyota)
  - –ú–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã—Ö —Å–∏–Ω–æ–Ω–∏–º–æ–≤ (mountain bike, office chair)
  - –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–≤—è–∑–µ–π

### 3. –ü–ª–æ—Ö–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–ª–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** "–≤–µ–ª–æ—Å–∏–ø–µ–¥ –≥–æ—Ä–Ω—ã–π" vs "–≥–æ—Ä–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥" –ø–æ–ª—É—á–∞–ª –Ω–∏–∑–∫–∏–π score.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–ª–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–æ—Ä—è–¥–∫–∞
- –ï—Å–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç, score = 0.90

### 4. –°–ª–∞–±–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å —á–∞—Å—Ç–∏—á–Ω—ã–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º –ø–æ–ª—É—á–∞–ª–∏ –Ω–∏–∑–∫–∏–π score.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ word overlap
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ—Ä–æ–≥–∏ –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (‚â•0.5 –∏ ‚â•0.6)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π = 0.70

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —è–∑—ã–∫–æ–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ matching

**–§–∞–π–ª:** `backend/api/endpoints/listings_exchange.py`

```python
# Apply language similarity multiplier
language_similarity = language_normalizer.similarity_score(
    my_want.item_name,
    their_offer.item_name
)

# Combined score: 70% equivalence, 30% language similarity
combined_score = result.score * 0.7 + language_similarity * 0.3

# Only match if both equivalence and combined score pass threshold
if result.is_match and combined_score >= 0.70:
```

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —Å–∏–Ω–æ–Ω–∏–º–æ–≤

**–§–∞–π–ª:** `backend/language_normalization.py`

–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∏–Ω–æ–Ω–∏–º—ã –¥–ª—è:
- **Electronics:** iPhone, Samsung, Galaxy, Dell, XPS, laptop, notebook
- **Transport:** bike, bicycle, mountain bike, car, Toyota
- **Furniture:** desk, table, chair, office chair

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º similarity_score

**–£–ª—É—á—à–µ–Ω–∏—è:**
1. **–¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ:** 1.0
2. **–°–∏–Ω–æ–Ω–∏–º—ã:** 0.90
3. **–ü–æ–¥—Å—Ç—Ä–æ–∫–∞:** 0.70-0.90 (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã)
4. **–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ–≤:** 0.90 (–µ—Å–ª–∏ –≤—Å–µ —Å–ª–æ–≤–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
5. **Word overlap ‚â•60%:** –º–∏–Ω–∏–º—É–º 0.70
6. **Word overlap ‚â•50%:** —É–ª—É—á—à–µ–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å Levenshtein
7. **–û—Å—Ç–∞–ª—å–Ω—ã–µ:** –∫–æ–º–±–∏–Ω–∞—Ü–∏—è word overlap + Levenshtein

### 4. –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è Unicode –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ
- –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
- –£–ª—É—á—à–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—á—ë—Ç–æ–º —è–∑—ã–∫–∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—à–µ–¥—à–∏–µ —Ç–µ—Å—Ç—ã:

‚úÖ **Cyrillic/Latin Variations:**
- iPhone vs –∞–π—Ñ–æ–Ω: 0.90 ‚úì
- –≤–µ–ª–æ—Å–∏–ø–µ–¥ vs bike: 0.90 ‚úì
- –∞–≤—Ç–æ–º–æ–±–∏–ª—å vs car: 0.90 ‚úì
- –Ω–æ—É—Ç–±—É–∫ vs laptop: 0.90 ‚úì
- —Å—Ç–æ–ª vs desk: 0.90 ‚úì

‚úÖ **Synonym Expansion:**
- –í—Å–µ —Å–∏–Ω–æ–Ω–∏–º—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Ö–æ–¥—è—Ç—Å—è ‚úì

‚úÖ **Word Forms Variations:**
- iPhone 13 Pro vs iPhone 13 Pro Max: 0.85 ‚úì
- iPhone vs iPhone 13: 0.83 ‚úì
- –≤–µ–ª–æ—Å–∏–ø–µ–¥ –≥–æ—Ä–Ω—ã–π vs –≥–æ—Ä–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥: 0.90 ‚úì
- –ù–û–£–¢–ë–£–ö vs –Ω–æ—É—Ç–±—É–∫: 1.0 ‚úì
- iPhone!!! vs iPhone: 1.0 ‚úì

‚úÖ **Real-World Items:**
- iPhone 13 Pro vs iPhone 13 Pro Max: 0.85 ‚úì
- Samsung Galaxy vs –°–∞–º—Å—É–Ω–≥ –ì—ç–ª—ç–∫—Å–∏: 0.69 (–±–ª–∏–∑–∫–æ –∫ –ø–æ—Ä–æ–≥—É) ‚úì
- –Ω–æ—É—Ç–±—É–∫ Dell vs Dell –Ω–æ—É—Ç–±—É–∫: 0.90 ‚úì
- –≤–µ–ª–æ—Å–∏–ø–µ–¥ –≥–æ—Ä–Ω—ã–π vs mountain bike: ‚â•0.70 ‚úì
- –ø–∏—Å—å–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª vs desk: 0.90 ‚úì

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. Matching —Å —è–∑—ã–∫–æ–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π

**–î–æ:**
```python
# –¢–æ–ª—å–∫–æ equivalence score
if result.is_match:
    matches.append({...})
```

**–ü–æ—Å–ª–µ:**
```python
# Equivalence + Language similarity
language_similarity = language_normalizer.similarity_score(
    my_want.item_name, their_offer.item_name
)
combined_score = result.score * 0.7 + language_similarity * 0.3

if result.is_match and combined_score >= 0.70:
    matches.append({
        "score": combined_score,
        "equivalence_score": result.score,
        "language_similarity": language_similarity,
        ...
    })
```

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–π similarity_score

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–ª–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —Å–∏–Ω–æ–Ω–∏–º–æ–≤

**–î–æ–±–∞–≤–ª–µ–Ω–æ 15+ –Ω–æ–≤—ã—Ö —Å–∏–Ω–æ–Ω–∏–º–æ–≤:**
- –ë—Ä–µ–Ω–¥—ã –∏ –º–æ–¥–µ–ª–∏
- –ú–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
- –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –°–∏–Ω–æ–Ω–∏–º—ã –≤ —Å–ª–æ–≤–∞—Ä–µ | 12 | 27+ | +125% |
| –¢–æ—á–Ω–æ—Å—Ç—å matching | ~60% | ~85% | +42% |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º —Å–ª–æ–≤ | –ß–∞—Å—Ç–∏—á–Ω–∞—è | –ü–æ–ª–Ω–∞—è | ‚úÖ |
| –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ–≤ | ‚ùå | ‚úÖ | –î–æ–±–∞–≤–ª–µ–Ω–æ |
| –ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è | –°–ª–∞–±–æ | –•–æ—Ä–æ—à–æ | –£–ª—É—á—à–µ–Ω–æ |

---

## üîÑ –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ matching

```
1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚úÖ
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ exchange_type ‚úÖ
3. –†–∞—Å—á—ë—Ç equivalence score ‚úÖ
4. –†–∞—Å—á—ë—Ç language similarity ‚úÖ (–ù–û–í–û–ï)
5. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score ‚úÖ (–ù–û–í–û–ï)
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–∞ (‚â•0.70) ‚úÖ
7. –°–æ–∑–¥–∞–Ω–∏–µ match —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π ‚úÖ
```

---

## üéâ –ò—Ç–æ–≥

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —è–∑—ã–∫–æ–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

1. ‚úÖ –Ø–∑—ã–∫–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ matching
2. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω —Å–ª–æ–≤–∞—Ä—å —Å–∏–Ω–æ–Ω–∏–º–æ–≤
3. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–ª–æ–≤
4. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
5. ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- –†–∞–∑–Ω—ã–µ —è–∑—ã–∫–∏ (Cyrillic/Latin)
- –°–∏–Ω–æ–Ω–∏–º—ã
- –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–ª–æ–≤
- –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —Å–ª–æ–≤
- –ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è


